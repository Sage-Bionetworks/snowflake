USE ROLE PUBLIC;
USE WAREHOUSE COMPUTE_ORG;
USE DATABASE SYNAPSE_DATA_WAREHOUSE;

SELECT DISTINCT FILE_NAME
FROM SYNAPSE_DATA_WAREHOUSE.SYNAPSE_RAW.FILESNAPSHOTS;

// File extensions
WITH FILE_EXTENSIONS AS (
    SELECT split_part(FILE_NAME, '.', -1) AS FILEEXT
    FROM SYNAPSE_DATA_WAREHOUSE.SYNAPSE.FILE_LATEST
)

SELECT
    FILEEXT,
    count(*) AS NUMBER_OF_FILES
FROM FILE_EXTENSIONS
GROUP BY FILEEXT
ORDER BY NUMBER_OF_FILES DESC;


// Number of change events
SELECT
    CHANGE_TYPE,
    count(*) AS NUMBER_OF_EVENTS
FROM SYNAPSE_DATA_WAREHOUSE.SYNAPSE.FILE_LATEST
GROUP BY CHANGE_TYPE;

// Number of counts for different statuses
SELECT
    STATUS,
    count(*) AS STATUS_COUNT
FROM SYNAPSE_DATA_WAREHOUSE.SYNAPSE.FILE_LATEST
GROUP BY STATUS;

-- TODO: Can you extract which projects have these mp4's and the folder
-- names under which they are stored, as a next step?
